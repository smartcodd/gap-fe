include mixins
doctype html
html(lang="en")
    head
        meta(charset="UTF-8")
        meta(name="viewport", content="width=device-width, initial-scale=1.0")
        meta(http-equiv="X-UA-Compatible", content="ie=edge")
        title Gestón de Agua Potable
        script(src="//ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js")
        link(href="//maxcdn.bootstrapcdn.com/bootswatch/3.3.0/flatly/bootstrap.min.css", rel="stylesheet")
        script( src='//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js' )
        link(rel="stylesheet", href="/docs/css/app.css")
        script(src="/socket.io/socket.io.js")
        script(src="/docs/js/handlebars.js")
        script(src="/docs/js/gap.js")
    body
        +navBar("SAAP","default","top","expand")
            +navBarNav("left")
                if USER
                    +nav_item( "/app" ,"nav-link")  Inicio
                    +nav_item_dropdown( "#" )( label="Opciones")    
                        +nav_divider
                        +nav_item( "/app/imagenes/new" ) Subir Imagen
                        +nav_item( "/app/imagenes" )  Mis Imagenes
            +navBarNav("right")
                if USER
                    +nav_item( "/logout" ) Salir
                else
                    +nav_item( "/login" ) Iniciar Sessión
                    +nav_item( "/signup" ) Registrarse
            +nav_divider
        div(class=["container-fluid"] style="padding-top:6rem;",id="container_gap")
            .row
                +columnaAll(12,2,2,2,2,2,1,"bd-sidebar")
                
                    
                    if listUsers
                        for user in listUsers
                            .sidebar-name
                                a(href="javascript:register_popup(#{user}, 'Narayan Prusty');")
                                    if user.conected=="S"
                                        button( type="button" class=["btn", "btn-success", "btn-circle","#{user._id}"] disabled="disabled" )
                                    else
                                        button( type="button" class=["btn", "btn-default", "btn-circle","#{user._id}"] disabled="disabled")
                                    span( class=["glyphicon", "glyphicon-user"])
                                    span #{user.username}
                                    span(class=["badge"] style="margin-left: 5px;font-size:8px;") 2
                                    
                                    if user.conected=="N"
                                        - var tiempo=user.date_desconected.getTime();
                                        - var tiempoActual=(new Date()).getTime();
                                        - var tiempoMiliSe=tiempoActual-tiempo;
                                        - var tiempoSeg=tiempoMiliSe/1000;
                                        - tiempoSeg=tiempoSeg.toFixed(0);
                                        - var tiempoConectado="";
                                        if tiempoSeg < 60
                                            - tiempoConectado=tiempoSeg+" seg";
                                        else
                                            - var tiempoMinutos=tiempoSeg/60;
                                            - tiempoMinutos=tiempoMinutos.toFixed(0);
                                            if tiempoMinutos < 60
                                                - tiempoConectado=tiempoMinutos+" min";
                                            else
                                                - var tiempoHoras=tiempoMinutos/60;
                                                - tiempoHoras=tiempoHoras.toFixed(0);
                                                if tiempoHoras < 24
                                                    - tiempoConectado=tiempoHoras+" h";
                                                else
                                                    - var tiempoDias=tiempoHoras/24;
                                                    - tiempoDias=tiempoDias.toFixed(0);
                                                    if tiempoHoras < 7
                                                        - tiempoConectado=tiempoDias+" d";
                                                    else
                                                        - var tiempoSemanas=tiempoDias/7;
                                                        - tiempoSemanas=tiempoSemanas.toFixed(0);
                                                        if tiempoSemanas < 4
                                                            - tiempoConectado=tiempoSemanas+" sem";
                                                        else
                                                            - var tiempoMeses=tiempoSemanas/4;
                                                            - tiempoMeses=tiempoMeses.toFixed(0);
                                                            if tiempoMeses < 12
                                                                - tiempoConectado=tiempoMeses+" meses";
                                                            else
                                                                - var tiempoAnios=tiempoSemanas/12;
                                                                - tiempoAnios=tiempoMeses.toFixed(0);
                                                                - tiempoConectado=tiempoAnios+" años"; 
                                        div(class=["floatRight"] style="margin-left: 5px;font-size:10px;") #{tiempoConectado}
                    if USER
                        include chat
                +columnaAll(12,10,10,10,10,4,5,"bd-content")
                    block contenido
        if USER
            input(type="hidden"  id="hiddenSecret" value="#{USER._id}")
                
